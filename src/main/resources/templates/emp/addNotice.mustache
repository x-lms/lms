<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•™ìŠµê´€ë¦¬ì‹œìŠ¤í…œ - ê³µì§€ì‚¬í•­ ì¶”ê°€</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <link rel="stylesheet" href="/css/common.css">
    <link rel="stylesheet" href="/css/layout.css">
    <link rel="stylesheet" href="/css/stylejm.css">
</head>
<body>
    <!-- include -->
    {{>layouts/header}}
    <div class="container">
        {{>layouts/navEmp}}
        <div class="main-content">
            <div class="page-header">
                <h2 class="page-title">ê³µì§€ì‚¬í•­ ì¶”ê°€</h2>
            </div>
            
            <div class="notice-form-container">
                <form class="notice-form" action="/emp/addNotice" method="post" enctype="multipart/form-data">
                    <div class="form-row">
                        <label class="form-label required">ì œëª©</label>
                        <input type="text" name="noticeTitle" class="form-input" placeholder="ê³µì§€ì‚¬í•­ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”" required>
                    </div>

                    <div class="form-row">
                        <label class="form-label required">ì‘ì„±ì</label>
                        <input type="text" name="noticeWriter" class="form-input" value="{{loginEmp.empName}}" readonly>
                    </div>

                    <div class="form-row">
                        <label class="form-label required">ë‚´ìš©</label>
                        <textarea name="noticeContents" class="form-textarea" rows="15" placeholder="ê³µì§€ì‚¬í•­ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”" required></textarea>
                    </div>

                    <div class="form-row">
                        <label class="form-label">ì²¨ë¶€íŒŒì¼</label>
                        <div class="file-upload-wrapper">
                            <input type="file" name="noticeFile" id="noticeFile" class="file-input" multiple>
                            <label for="noticeFile" class="file-label">
                                <span class="file-icon">ğŸ“</span>
                                <span class="file-text">íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ ë“œë˜ê·¸í•˜ì„¸ìš”</span>
                            </label>
                            <div class="file-list"></div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <a href="/public/noticeList" class="btn-secondary">ì·¨ì†Œ</a>
                        <button type="submit" class="btn-primary">ë“±ë¡</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
	{{>layouts/footer}}

	<script>
		// íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬
		$('#noticeFile').on('change', function(e) {
		    const files = e.target.files;
		    displayFiles(files);
		});
		
		// íŒŒì¼ ëª©ë¡ í‘œì‹œ í•¨ìˆ˜
		function displayFiles(files) {
		    const fileList = $('.file-list');
		    fileList.empty();
		    
		    if(files.length > 0) {
		        for(let i = 0; i < files.length; i++) {
		            fileList.append(`
		                <div class="file-item">
		                    <span class="file-name">${files[i].name}</span>
		                    <span class="file-size">(${(files[i].size / 1024).toFixed(2)} KB)</span>
		                </div>
		            `);
		        }
		    }
		}
        
		// ë“œë˜ê·¸ ì•¤ ë“œë¡­ ê¸°ëŠ¥
		let fileLabel = $('.file-label');
		
		fileLabel.on('dragover', function(e) {
			e.preventDefault();
			e.stopPropagation();
			$(this).addClass('drag-over');
		});
		
		fileLabel.on('dragleave', function(e) {
		    e.preventDefault();
		    e.stopPropagation();
		    $(this).removeClass('drag-over');
		});
		
		fileLabel.on('drop', function(e) {
			e.preventDefault();
			e.stopPropagation();
			$(this).removeClass('drag-over');
			
			const newFiles = e.originalEvent.dataTransfer.files;
			
			// ê¸°ì¡´íŒŒì¼ + ìƒˆíŒŒì¼ í•©ì¹˜ê¸°
			let dt = new DataTransfer();
			
			// ê¸°ì¡´ íŒŒì¼ ìœ ì§€
			const currentFiles = $('#noticeFile')[0].files;
			for(let i = 0; i < currentFiles.length; i++) {
				dt.items.add(currentFiles[i]);
			}
			
			// ìƒˆë¡œ ë“œë¡­ëœ íŒŒì¼ ì¶”ê°€
			for(let i = 0; i < newFiles.length; i++) {
				dt.items.add(newFiles[i]);
			}
			// inputì— ë‹¤ì‹œ ë„£ê¸°
			$('#noticeFile')[0].files = dt.files;
			displayFiles($('#noticeFile')[0].files);
		});
    </script>
</body>
</html>