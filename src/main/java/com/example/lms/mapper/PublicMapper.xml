<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.lms.mapper.PublicMapper">
	<!-- 학생로그인 -->


<select id="selectLoginStudent" parameterType="com.example.lms.dto.LoginUser" resultType="com.example.lms.dto.Student">
	    select 
	        student_no AS studentNo,
	        dept_no AS deptNo,
	        student_name AS studentName,
	        student_img AS studentImg,
	        student_state AS studentState
	    from student 
	    where student_no = CAST(#{userId} AS UNSIGNED)
	      and student_pw = #{userPw}
</select>


	<!-- 교수로그인 -->
	<select id="selectLoginProfessor" parameterType="com.example.lms.dto.LoginUser" resultType="com.example.lms.dto.Emp">
		SELECT emp_no empNo, emp_email empEmail, emp_name empName, dept_no deptNo, emp_img empImg
		FROM emp 
		WHERE emp_role= 2 AND emp_email = #{userId} AND emp_pw = #{userPw}
	</select>
	<!-- 교직원로그인 -->
	<select id="selectLoginEmp" parameterType="com.example.lms.dto.LoginUser" resultType="com.example.lms.dto.Emp">
		SELECT emp_no empNo, emp_email empEmail, emp_name empName, emp_img empImg
		FROM emp 
		WHERE emp_role= 1 AND emp_email = #{userId} AND emp_pw = #{userPw}
	</select>
	<!-- 공지사항 리스트 -->
	<select id="selectNoticeList" parameterType="com.example.lms.dto.SearchList" resultType="com.example.lms.dto.Notice">
		SELECT notice_no noticeNo, notice_writer noticeWriter, notice_title noticeTitle, DATE_FORMAT(createdate, '%Y.%m.%d') createdate
		FROM notice
		<where>
			<if test="searchWord != null and searchWord.trim() != ''">
				notice_title LIKE CONCAT('%', #{searchWord}, '%')
				OR notice_contents LIKE CONCAT('%', #{searchWord}, '%')
			</if>
		</where>
		ORDER BY createdate DESC LIMIT #{beginRow}, #{rowPerPage}
	</select>
	<select id="countNotice" parameterType="String" resultType="int">
		SELECT COUNT(notice_no)
		FROM notice
		<where>
			<if test="searchWord != null and searchWord.trim() != ''">
				notice_title LIKE CONCAT('%', #{searchWord}, '%')
				OR notice_contents LIKE CONCAT('%', #{searchWord}, '%')
			</if>
		</where>
	</select>
</mapper>